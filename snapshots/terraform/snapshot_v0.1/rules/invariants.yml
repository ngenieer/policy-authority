rules:
  - id: TF-INVARIANT-001
    title: "Encryption must not be disabled"
    enforcement:
      mode: fail
    match:
      files:
        - "**/*.tf"
        - "**/*.tfvars"
        - "**/*.auto.tfvars"
      required_absent:
        - "encrypted = false"
        - "kms_master_key_id = \"\""

  - id: TF-INVARIANT-002
    title: "No hardcoded shared secrets"
    enforcement:
      mode: fail
    match:
      files:
        - "**/*.tf"
        - "**/*.tfvars"
        - "**/*.auto.tfvars"
      required_absent:
        - "shared_secret"
        - "hardcoded_password"
