# Boundaries â€” Hard FAIL conditions for terraform/snapshot_v0.1
# Any match MUST produce FAIL and halt evaluation (short-circuit).

boundaries:
  - id: no_public_ingress
    description: Disallow public ingress (0.0.0.0/0) in security group rules.
    match:
      files:
        - "**/*.tf"
      contains:
        - "0.0.0.0/0"

  - id: no_wildcard_iam
    description: Disallow wildcard IAM permissions.
    match:
      files:
        - "**/*.tf"
      contains:
        - "*"

  - id: require_encryption_at_rest
    description: Require encryption at rest for managed resources.
    match:
      files:
        - "**/*.tf"
      contains:
        - "encrypted = false"
